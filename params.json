{"name":"http-sniffer","tagline":"A multi-threading tool to sniff TCP flow statistics and embedded HTTP headers from PCAP file. Each TCP flow carrying HTTP is exported to text file in json format.","body":"http-sniffer\r\n==========\r\n\r\n[![Build Status](https://travis-ci.org/caesar0301/http-sniffer.svg)](https://travis-ci.org/caesar0301/http-sniffer)\r\n\r\nA multi-threading tool to sniff HTTP header records beyond TCP flow statistics.\r\n\r\n**MIT licensed.**\r\n\r\nFeatures\r\n------------\r\n\r\n* Support both offline PCAP file and live NIC sniffing\r\n* Perform multi-threading process, whereby the tool gets higher performance in face of big tarffic volume\r\n* Export statistics of TCP flows\r\n* Export HTTP request/response pairs if they are present in the TCP flow\r\n* Support JSON format output\r\n\r\n\r\nDependencis\r\n------------\r\n\r\nThe `http-sniffer` depends on other utilities:\r\n\r\n  * [libpcap](http://www.tcpdump.org/) to extract traffic packet,\r\n  * [json-c](https://github.com/json-c/json-c) to support json parsing, and\r\n  * [scons](http://www.scons.org/) to build the project.\r\n\r\n\r\nA known issue about `json-c` is the unused params errors on linux platform,\r\nyou can use an [alternative](https://github.com/phalcon/json-c) to solve it.\r\nYou may also need to export the library path where `libjson-c.*` locate, by\r\n\r\n    export LD_LIBRARY_PATH=/usr/local/lib\r\n\r\n\r\nHow to Use\r\n----------\r\n\r\nRun `scons` in root folder to compile:\r\n\r\n    $ cd http-sniffer\r\n    $ scons\r\n\r\nGet your live interface with `ifconfig` in terminal, e.g. `en0`, then\r\n\r\n    $ ./bin/http-sniffer -i en0\r\n\r\nOr store output flows as json\r\n\r\n    $ ./bin/http-sniffer -i en0 -o output.json\r\n\r\n\r\nOutput\r\n------\r\n\r\n* In brief CSV format:\r\n\r\n```csv\r\n[20120921 16:40:09]10.187.179.28:53196-->180.149.134.229:80 1335164797.208360 0.0 0.0 167 5/3 0/0 0 0\r\n[20120921 16:40:09]10.187.179.28:53160-->58.63.234.206:80 1335164789.893109 0.0 0.0 21 4/2 0/0 0 0\r\n[20120921 16:40:09]10.187.179.28:53161-->58.63.234.206:80 1335164789.893219 0.0 0.0 225 4/2 0/0 0 0\r\n[20120921 16:40:09]10.187.179.28:53158-->58.63.234.198:80 1335164789.769004 0.0 0.0 118 4/2 0/0 0 0\r\n[20120921 16:40:09]10.187.179.28:53164-->113.108.216.252:80 1335164790.179680 0.0 0.0 12 4/2 0/0 0 0\r\n[20120921 16:40:09]10.187.179.28:53189-->180.149.134.221:80 1335164797.961918 0.0 0.0 111 3/1 0/0 0 0\r\n```\r\n\r\n* In full JSON format: each line records **one** TCP flow with piggybacked HTTP messages, e.g.\r\n\r\n```json\r\n{\r\n   \"time_local\": \"2012-04-23T13:50:09\",\r\n   \"saddr\": \"192.168.1.4\", \r\n   \"daddr\": \"192.168.1.5\", \r\n   \"sport\": 45753, \r\n   \"dport\": 80, \r\n   \"time_syn\": 1335160209.417475, \r\n   \"time_first_byte\": 1335160209.452336, \r\n   \"time_last_byte\": 1335160209.488276, \r\n   \"rtt\": 248, \r\n   \"src_packets\": 4, \r\n   \"dst_packets\": 4, \r\n   \"src_bytes\": 521, \r\n   \"dst_bytes\": 257, \r\n   \"http_pair_count\": 1, \r\n   \"force_closed\": 0, \r\n   \"http_pairs\": [ \r\n    { \r\n     \"request\": { \r\n      \"time_first_byte\": 1335160209.452336, \r\n      \"time_last_byte\": 1335160209.452336, \r\n      \"bytes_transfered\": 521, \r\n      \"http_version\": 1, \r\n      \"method\": 1, \r\n      \"host\": \"s1.bdstatic.com\", \r\n      \"uri\": \"\\/r\\/www\\/img\\/i-1.0.0.png\", \r\n      \"referer\": \"http:\\/\\/www.baidu.com\\/\", \r\n      \"user_agent\": \"Mozilla\\/5.0\", \r\n      \"accept\": \"image\\/png,image\\/*;q=0.8,*\\/*;q=0.5\", \r\n      \"accept_encoding\": \"gzip,deflate\", \r\n      \"accept_language\": \"en-us,en;q=0.5\", \r\n      \"accept_charset\": \"ISO-8859-1,utf-8;q=0.7,*;q=0.7\"}, \r\n     \"response\": {\r\n      \"time_first_byte\": 1335160209.488260, \r\n      \"time_last_byte\": 1335160209.488260, \r\n      \"bytes_transfered\": 257, \r\n      \"http_version\": 1, \r\n      \"status\": 304, \r\n      \"server\": \"JSP\\/1.0.18\", \r\n      \"date\": \"Mon, 23 Apr 2012 06:02:23 GMT\", \r\n      \"expires\": \"Tue, 29 Mar 2022 09:34:06 GMT\", \r\n      \"etag\": \"\\\"25f-4a6ebc21c42c0\\\"\", \r\n      \"last_modified\": \"Thu, 30 Jun 2011 10:56:51 GMT\"} \r\n    }] \r\n}\r\n```\r\n\r\n\r\nAbout Author\r\n------------\r\n\r\nXiaming Chen <chen@xiaming.me>\r\n\r\nSJTU, Shanghai, China\r\n\r\n2012-04-01\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}